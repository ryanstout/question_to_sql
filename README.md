# NLP Query

A BI tool that lets you dig into your data using natural language

# Development

All local installation is documented in:

```shell
bin/setup.sh
npm run dev
```

# Prisma

Generate the python and ts schemas with:
`prisma generate --schema prisma/schema.prisma`

# Import DataSource

python -m python.import {user_id}

# Schemas [WIP]

Place your test database in a local postgres (currenthly hardcoded to db name of witharsenal_prod_copy)

Generate the schema with:
`ts-node --require tsconfig-paths/register  --transpileOnly app/models/generate_schema.ts > prisma/test_schema.sql`

# --------

# Tables

# --------

# User

# QuestionGroup

has_many :questions
correctSql - the sql that correctly answers the question (updated when marked as correct)

# Question

question - the english question
userSql - the sql edited by the user
codexSql - the sql generated by codex model
correctState - null, 0 = incorrect, 1 = correct

# TODO:

translate DATE_TRUNC('month', created_at) to

Test questions:
How many people who bought an Arsenal 2 Pro also bought a phone mount?
How many people who bought a sd card also bought a phone mount?
What percent of orders use each shipping method?
How many pacific northwest customers spent more than $160?
How many Arsenal 2 Pro's have been sold each month?
What are the fields in the orders table?
What credit card is used most in Germany?
For the shipments that failed, how much money was spent on their associated order?
What products have been shipped to ryanstout@gmail.com?
What are the top selling products each december?
What percent of orders that bought a phone mount spent more than $300?

Future support:
Sumarize some text field...

# Connections

## Shopify

- [Staff role](https://help.shopify.com/en/manual/your-account/staff-accounts/staff-permissions/staff-permissions-descriptions#apps-and-channels-permissions) does not allow us to create API keys. API keys must be created by generating a private app, which requires a specific permissions set. [More info.](https://help.plytix.com/en/getting-api-credentials-from-your-shopify-store)
